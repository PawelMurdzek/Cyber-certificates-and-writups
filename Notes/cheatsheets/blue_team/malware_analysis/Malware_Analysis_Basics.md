# Malware Analysis Cheatsheet

## Lab Setup
- **REMnux**: Linux toolkit for reverse engineering and malware analysis.
- **FLARE-VM**: Windows-based security distribution for malware analysis.

> [!WARNING]
> ALWAYS perform malware analysis in an isolated, virtualized environment (Sandbox) with no internet access unless explicitly required and monitored.

## Static Analysis (Basic)
Examining the file without running it.

### File Identification & Hashing
```bash
file suspicious.exe
md5sum suspicious.exe
sha256sum suspicious.exe
```

### Strings
Extract readable text from binary.
```bash
strings -n 10 suspicious.exe | less
floss suspicious.exe  # FireEye Labs Obfuscated String Solver
```

### PE Analysis (Windows Headers)
- **PEStudio**: Check imports, exports, sections, and VirusTotal score.
- **PEBear**: Visual PE viewer.
- **CFF Explorer**: Edit PE headers.

### Packing Detection
- **Detect It Easy (DiE)**: Identify compiler/packer (UPX, etc.).
- **Exeinfo PE**: Similar to DiE.

## Dynamic Analysis
Running the malware in a controlled environment.

### Monitoring Tools
- **Procmon (Process Monitor)**: File system, Registry, Process activity.
    - *Filter*: ProcessName is `malware.exe`.
- **Process Hacker / Process Explorer**: View running processes, handles, memory strings.
- **RegShot**: Take registry snapshots before and after execution to compare.
- **Wireshark / Fiddler**: Capture network traffic (FakeNet-NG for simulation).

### Sandboxes
- **Any.Run**: Interactive online sandbox.
- **Hybrid Analysis**: Automated malware analysis.
- **Cuckoo Sandbox**: Open Source automated malware analysis system.
